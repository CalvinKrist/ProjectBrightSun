{"version":3,"sources":["../src/builder.ts"],"names":[],"mappings":"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","sourcesContent":["import { addValue, Arch, archFromString, deepAssign, getArchCliNames, InvalidConfigurationError, log } from \"builder-util\"\nimport chalk from \"chalk\"\nimport { build as _build, Configuration, DIR_TARGET, Packager, PackagerOptions, Platform } from \"app-builder-lib\"\nimport { PublishOptions } from \"electron-publish\"\n\n/** @internal */\nexport interface BuildOptions extends PackagerOptions, PublishOptions {\n}\n\nexport interface CliOptions extends PackagerOptions, PublishOptions {\n  arch?: string\n\n  x64?: boolean\n  ia32?: boolean\n  armv7l?: boolean\n  arm64?: boolean\n\n  dir?: boolean\n\n  platform?: string\n}\n\n/** @internal */\nexport function normalizeOptions(args: CliOptions): BuildOptions {\n  if ((args as any).extraMetadata != null) {\n    throw new InvalidConfigurationError(\"Please specify extraMetadata under config field\")\n  }\n\n  if (args.targets != null) {\n    return args\n  }\n\n  if ((args as any).draft != null || (args as any).prerelease != null) {\n    log.warn({solution: \"set releaseType (http://electron.build/configuration/publish#GithubOptions-releaseType) in the GitHub publish options\"}, \"--draft and --prerelease is deprecated\")\n  }\n\n  let targets = new Map<Platform, Map<Arch, Array<string>>>()\n\n  function processTargets(platform: Platform, types: Array<string>) {\n    function commonArch(currentIfNotSpecified: boolean): Array<Arch> {\n      if (platform === Platform.MAC) {\n        return args.x64 || currentIfNotSpecified ? [Arch.x64] : []\n      }\n\n      const result = Array<Arch>()\n      if (args.x64) {\n        result.push(Arch.x64)\n      }\n      if (args.armv7l) {\n        result.push(Arch.armv7l)\n      }\n      if (args.arm64) {\n        result.push(Arch.arm64)\n      }\n      if (args.ia32) {\n        result.push(Arch.ia32)\n      }\n\n      return result.length === 0 && currentIfNotSpecified ? [archFromString(process.arch)] : result\n    }\n\n    if (args.platform != null) {\n      throw new InvalidConfigurationError(`--platform cannot be used if --${platform.buildConfigurationKey} is passed`)\n    }\n    if (args.arch != null) {\n      throw new InvalidConfigurationError(`--arch cannot be used if --${platform.buildConfigurationKey} is passed`)\n    }\n\n    let archToType = targets.get(platform)\n    if (archToType == null) {\n      archToType = new Map<Arch, Array<string>>()\n      targets.set(platform, archToType)\n    }\n\n    if (types.length === 0) {\n      const defaultTargetValue = args.dir ? [DIR_TARGET] : []\n      for (const arch of commonArch(args.dir === true)) {\n        archToType.set(arch, defaultTargetValue)\n      }\n      return\n    }\n\n    for (const type of types) {\n      const suffixPos = type.lastIndexOf(\":\")\n      if (suffixPos > 0) {\n        addValue(archToType, archFromString(type.substring(suffixPos + 1)), type.substring(0, suffixPos))\n      }\n      else {\n        for (const arch of commonArch(true)) {\n          addValue(archToType, arch, type)\n        }\n      }\n    }\n  }\n\n  if (args.mac != null) {\n    processTargets(Platform.MAC, args.mac)\n  }\n\n  if (args.linux != null) {\n    processTargets(Platform.LINUX, args.linux)\n  }\n\n  if (args.win != null) {\n    processTargets(Platform.WINDOWS, args.win)\n  }\n\n  if (targets.size === 0) {\n    if (args.platform == null && args.arch == null) {\n      processTargets(Platform.current(), [])\n    }\n    else {\n      targets = createTargets(normalizePlatforms(args.platform), args.dir ? DIR_TARGET : null, args.arch)\n    }\n  }\n\n  const result = {...args}\n  result.targets = targets\n\n  delete result.dir\n  delete result.mac\n  delete result.linux\n  delete result.win\n  delete result.platform\n  delete result.arch\n\n  const r = result as any\n  delete r.m\n  delete r.o\n  delete r.l\n  delete r.w\n  delete r.windows\n  delete r.macos\n  delete r.$0\n  delete r._\n  delete r.version\n  delete r.help\n  delete r.c\n  delete r.p\n  delete r.pd\n\n  delete result.ia32\n  delete result.x64\n  delete result.armv7l\n  delete result.arm64\n\n  let config = result.config\n\n  // config is array when combining dot-notation values with a config file value\n  // https://github.com/electron-userland/electron-builder/issues/2016\n  if (Array.isArray(config)) {\n    const newConfig: Configuration = {}\n    for (const configItem of config) {\n      if (typeof configItem === \"object\") {\n        deepAssign(newConfig, configItem)\n      }\n      else if (typeof configItem === \"string\") {\n        newConfig.extends = configItem\n      }\n    }\n\n    config = newConfig\n    result.config = newConfig\n  }\n\n  if (config != null && typeof config !== \"string\") {\n    if (config.extraMetadata != null) {\n      coerceTypes(config.extraMetadata)\n    }\n    if (config.mac != null) {\n      // ability to disable code sign using -c.mac.identity=null\n      coerceValue(config.mac, \"identity\")\n    }\n  }\n\n  if (\"project\" in r && !(\"projectDir\" in result)) {\n    result.projectDir = r.project\n  }\n  delete r.project\n\n  return result as BuildOptions\n}\n\nfunction coerceValue(host: any, key: string): void {\n  const value = host[key]\n  if (value === \"true\") {\n    host[key] = true\n  }\n  else if (value === \"false\") {\n    host[key] = false\n  }\n  else if (value === \"null\") {\n    host[key] = null\n  }\n  else if (key === \"version\" && typeof value === \"number\") {\n    host[key] = value.toString()\n  }\n  else if (value != null && typeof value === \"object\") {\n    coerceTypes(value)\n  }\n}\n\n/** @private */\nexport function coerceTypes(host: any): any {\n  for (const key of Object.getOwnPropertyNames(host)) {\n    coerceValue(host, key)\n  }\n  return host\n}\n\nexport function createTargets(platforms: Array<Platform>, type?: string | null, arch?: string | null): Map<Platform, Map<Arch, Array<string>>> {\n  const targets = new Map<Platform, Map<Arch, Array<string>>>()\n  for (const platform of platforms) {\n    const archs = platform === Platform.MAC ? [Arch.x64] : (arch === \"all\" ? [Arch.x64, Arch.ia32] : [archFromString(arch == null ? process.arch : arch)])\n    const archToType = new Map<Arch, Array<string>>()\n    targets.set(platform, archToType)\n\n    for (const arch of archs) {\n      archToType.set(arch, type == null ? [] : [type])\n    }\n  }\n  return targets\n}\n\nexport function build(rawOptions?: CliOptions): Promise<Array<string>> {\n  const buildOptions = normalizeOptions(rawOptions || {})\n  return _build(buildOptions, new Packager(buildOptions))\n}\n\n/**\n * @private\n * @internal\n */\nexport function configureBuildCommand(yargs: yargs.Yargs): yargs.Yargs {\n  const publishGroup = \"Publishing:\"\n  const buildGroup = \"Building:\"\n  const deprecated = \"Deprecated:\"\n\n  return yargs\n    .option(\"mac\", {\n      group: buildGroup,\n      alias: [\"m\", \"o\", \"macos\"],\n      description: `Build for macOS, accepts target list (see ${chalk.underline(\"https://goo.gl/5uHuzj\")}).`,\n      type: \"array\",\n    })\n    .option(\"linux\", {\n      group: buildGroup,\n      alias: \"l\",\n      description: `Build for Linux, accepts target list (see ${chalk.underline(\"https://goo.gl/4vwQad\")})`,\n      type: \"array\",\n    })\n    .option(\"win\", {\n      group: buildGroup,\n      alias: [\"w\", \"windows\"],\n      description: `Build for Windows, accepts target list (see ${chalk.underline(\"https://goo.gl/jYsTEJ\")})`,\n      type: \"array\",\n    })\n    .option(\"x64\", {\n      group: buildGroup,\n      description: \"Build for x64\",\n      type: \"boolean\",\n    })\n    .option(\"ia32\", {\n      group: buildGroup,\n      description: \"Build for ia32\",\n      type: \"boolean\",\n    })\n    .option(\"armv7l\", {\n      group: buildGroup,\n      description: \"Build for armv7l\",\n      type: \"boolean\",\n    })\n    .option(\"arm64\", {\n      group: buildGroup,\n      description: \"Build for arm64\",\n      type: \"boolean\",\n    })\n    .option(\"dir\", {\n      group: buildGroup,\n      description: \"Build unpacked dir. Useful to test.\",\n      type: \"boolean\",\n    })\n    .option(\"publish\", {\n      group: publishGroup,\n      alias: \"p\",\n      description: `Publish artifacts, see ${chalk.underline(\"https://goo.gl/tSFycD\")}`,\n      choices: [\"onTag\", \"onTagOrDraft\", \"always\", \"never\", undefined as any],\n    })\n    .option(\"draft\", {\n      group: deprecated,\n      description: \"Please set releaseType in the GitHub publish options instead\",\n      type: \"boolean\",\n      default: undefined,\n    })\n    .option(\"prerelease\", {\n      group: deprecated,\n      description: \"Please set releaseType in the GitHub publish options instead\",\n      type: \"boolean\",\n      default: undefined,\n    })\n    .option(\"platform\", {\n      group: deprecated,\n      description: \"The target platform (preferred to use --mac, --win or --linux)\",\n      choices: [\"mac\", \"win\", \"linux\", \"darwin\", \"win32\", \"all\", undefined as any],\n    })\n    .option(\"arch\", {\n      group: deprecated,\n      description: \"The target arch (preferred to use --x64 or --ia32)\",\n      choices: getArchCliNames().concat(\"all\", undefined as any),\n    })\n    .option(\"prepackaged\", {\n      alias: [\"pd\"],\n      group: buildGroup,\n      description: \"The path to prepackaged app (to pack in a distributable format)\",\n    })\n    .option(\"projectDir\", {\n      alias: [\"project\"],\n      group: buildGroup,\n      description: \"The path to project directory. Defaults to current working directory.\",\n    })\n    .option(\"config\", {\n      alias: [\"c\"],\n      group: buildGroup,\n      description: \"The path to an electron-builder config. Defaults to `electron-builder.yml` (or `json`, or `json5`), see \" + chalk.underline(\"https://goo.gl/YFRJOM\"),\n    })\n    .group([\"help\", \"version\"], \"Other:\")\n    .example(\"electron-builder -mwl\", \"build for macOS, Windows and Linux\")\n    .example(\"electron-builder --linux deb tar.xz\", \"build deb and tar.xz for Linux\")\n    .example(\"electron-builder --win --ia32\", \"build for Windows ia32\")\n    .example(\"electron-builder -c.extraMetadata.foo=bar\", \"set package.json property `foo` to `bar`\")\n    .example(\"electron-builder --config.nsis.unicode=false\", \"configure unicode options for NSIS\")\n}\n\nfunction normalizePlatforms(rawPlatforms: Array<string | Platform> | string | Platform | null | undefined): Array<Platform> {\n  const platforms = rawPlatforms == null || Array.isArray(rawPlatforms) ? (rawPlatforms as Array<string | Platform | null | undefined>) : [rawPlatforms]\n  if (platforms as any == null || platforms.length === 0) {\n    return [Platform.fromString(process.platform)]\n  }\n  else if (platforms[0] === \"all\") {\n    if (process.platform === Platform.MAC.nodeName) {\n      return [Platform.MAC, Platform.LINUX, Platform.WINDOWS]\n    }\n    else if (process.platform === Platform.LINUX.nodeName) {\n      // macOS code sign works only on macOS\n      return [Platform.LINUX, Platform.WINDOWS]\n    }\n    else {\n      return [Platform.WINDOWS]\n    }\n  }\n  else {\n    return platforms.map(it => it instanceof Platform ? it : Platform.fromString(it!))\n  }\n}"],"sourceRoot":""}
