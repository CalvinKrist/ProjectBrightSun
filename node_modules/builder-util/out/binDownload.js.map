{"version":3,"sources":["../src/binDownload.ts"],"names":[],"mappings":";;;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA,MAAM,mBAAmB,IAAI,GAAJ,EAAzB;;AAEM,SAAU,QAAV,CAAmB,GAAnB,EAAgC,MAAhC,EAAgD,QAAhD,EAAwE;AAC5E,QAAM,OAAO,CAAC,UAAD,EAAa,OAAb,EAAsB,GAAtB,EAA2B,UAA3B,EAAuC,MAAvC,CAAb;;AACA,MAAI,YAAY,IAAhB,EAAsB;AACpB,SAAK,IAAL,CAAU,UAAV,EAAsB,QAAtB;AACD;;AACD,SAAO,+BAAkB,IAAlB,CAAP;AACD;;AAEK,SAAU,gBAAV,CAA2B,IAA3B,EAAyC,OAAzC,EAA0D,QAA1D,EAA0E;AAC9E,QAAM,UAAU,GAAG,IAAI,IAAI,OAAO,EAAlC;AACA,SAAO,OAAO,OAAP,EAAgB,oFAAoF,OAAO,IAAI,OAAO,KAAtH,EAA6H,QAA7H,CAAP;AACD;;AAEK,SAAU,MAAV,CAAiB,IAAjB,EAA+B,GAA/B,EAA4C,QAA5C,EAAmE;AACvE,MAAI,UAAU,iBAAiB,GAAjB,CAAqB,IAArB,CAAd,CADuE,CAEvE;;AACA,MAAI,WAAW,IAAf,EAAqB;AACnB,WAAO,OAAP;AACD;;AAED,YAAU,SAAS,IAAT,EAAe,GAAf,EAAoB,QAApB,CAAV;AACA,mBAAiB,GAAjB,CAAqB,IAArB,EAA2B,OAA3B;AACA,SAAO,OAAP;AACD;;AAED,SAAS,QAAT,CAAkB,IAAlB,EAAgC,GAAhC,EAA6C,QAA7C,EAAoE;AAClE,QAAM,OAAO,CAAC,mBAAD,EAAsB,OAAtB,EAA+B,GAA/B,EAAoC,QAApC,EAA8C,IAA9C,CAAb;;AACA,MAAI,YAAY,IAAhB,EAAsB;AACpB,SAAK,IAAL,CAAU,UAAV,EAAsB,QAAtB;AACD;;AAED,SAAO,+BAAkB,IAAlB,CAAP;AACD,C","sourcesContent":["import { executeAppBuilder } from \"./util\"\n\nconst versionToPromise = new Map<string, Promise<string>>()\n\nexport function download(url: string, output: string, checksum?: string | null): Promise<void> {\n  const args = [\"download\", \"--url\", url, \"--output\", output]\n  if (checksum != null) {\n    args.push(\"--sha512\", checksum)\n  }\n  return executeAppBuilder(args) as Promise<any>\n}\n\nexport function getBinFromGithub(name: string, version: string, checksum: string): Promise<string> {\n  const dirName = `${name}-${version}`\n  return getBin(dirName, `https://github.com/electron-userland/electron-builder-binaries/releases/download/${dirName}/${dirName}.7z`, checksum)\n}\n\nexport function getBin(name: string, url: string, checksum: string | null): Promise<string> {\n  let promise = versionToPromise.get(name)\n  // if rejected, we will try to download again\n  if (promise != null) {\n    return promise\n  }\n\n  promise = doGetBin(name, url, checksum)\n  versionToPromise.set(name, promise)\n  return promise\n}\n\nfunction doGetBin(name: string, url: string, checksum: string | null): Promise<string> {\n  const args = [\"download-artifact\", \"--url\", url, \"--name\", name]\n  if (checksum != null) {\n    args.push(\"--sha512\", checksum)\n  }\n\n  return executeAppBuilder(args)\n}"],"sourceRoot":""}
