{"version":3,"sources":["../../src/vm/vm.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAEM,MAAO,SAAP,CAAgB;AACpB,MAAI,OAAJ,GAAW;AACT,WAAO,KAAK,GAAZ;AACD;;AAED,OAAK,IAAL,EAAmB,IAAnB,EAAwC,OAAxC,EAAmE,kBAAkB,IAArF,EAAyF;AACvF,WAAO,yBAAK,IAAL,EAAW,IAAX,EAAiB,OAAjB,EAA0B,eAA1B,CAAP;AACD;;AAED,QAAM,IAAN,EAAoB,IAApB,EAAyC,OAAzC,EAAiE,YAAjE,EAAiG;AAC/F,WAAO,0BAAM,IAAN,EAAY,IAAZ,EAAkB,OAAlB,EAA2B,YAA3B,CAAP;AACD;;AAED,WAAS,IAAT,EAAqB;AACnB,WAAO,IAAP;AACD;;AAfmB;;;;;2CAkBf,WAA4B,WAA5B,EAAoD;AACzD,UAAM,SAAS,CAAC,MAAM,gCAAY,WAAZ,CAAP,EAAiC,MAAjC,CAAwC,MAAM,GAAG,EAAH,KAAU,QAAxD,CAAf;;AACA,QAAI,OAAO,MAAP,KAAkB,CAAtB,EAAyB;AACvB,YAAM,KAAI,wCAAJ,EAA8B,iFAA9B,CAAN;AACD,KAJwD,CAMzD;;;AACA,WAAO,KAAI,iCAAJ,EAAuB,OAAO,IAAP,CAAY,MAAM,GAAG,KAAH,KAAa,SAA/B,KAA6C,OAAO,IAAP,CAAY,MAAM,GAAG,KAAH,KAAa,WAA/B,CAA7C,IAA4F,OAAO,CAAP,CAAnH,CAAP;AACD,G;;kBARqB,Y","sourcesContent":["import { DebugLogger, exec, ExtraSpawnOptions, InvalidConfigurationError, spawn } from \"builder-util\"\nimport { ExecFileOptions, SpawnOptions } from \"child_process\"\nimport * as path from \"path\"\nimport { ParallelsVmManager, parseVmList } from \"./ParallelsVm\"\n\nexport class VmManager {\n  get pathSep(): string {\n    return path.sep\n  }\n\n  exec(file: string, args: Array<string>, options?: ExecFileOptions, isLogOutIfDebug = true): Promise<string> {\n    return exec(file, args, options, isLogOutIfDebug)\n  }\n\n  spawn(file: string, args: Array<string>, options?: SpawnOptions, extraOptions?: ExtraSpawnOptions): Promise<any> {\n    return spawn(file, args, options, extraOptions)\n  }\n\n  toVmFile(file: string): string {\n    return file\n  }\n}\n\nexport async function getWindowsVm(debugLogger: DebugLogger): Promise<VmManager> {\n  const vmList = (await parseVmList(debugLogger)).filter(it => it.os === \"win-10\")\n  if (vmList.length === 0) {\n    throw new InvalidConfigurationError(\"Cannot find suitable Parallels Desktop virtual machine (Windows 10 is required)\")\n  }\n\n  // prefer running or suspended vm\n  return new ParallelsVmManager(vmList.find(it => it.state === \"running\") || vmList.find(it => it.state === \"suspended\") || vmList[0])\n}"],"sourceRoot":""}
